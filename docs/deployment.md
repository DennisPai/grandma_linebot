# éƒ¨ç½²æŒ‡å—

## å¿«é€Ÿéƒ¨ç½²æµç¨‹

### å‰ææ¢ä»¶

- âœ… GitHub å¸³è™Ÿ
- âœ… Zeabur å¸³è™Ÿ
- âœ… å·²å–å¾—æ‰€æœ‰å¿…è¦çš„ API é‡‘é‘°ï¼ˆåƒè€ƒ MANUAL_SETUP_GUIDE.mdï¼‰

### éƒ¨ç½²æ­¥é©Ÿæ‘˜è¦

1. **æ¨é€ç¨‹å¼ç¢¼åˆ° GitHub** â†’ è‡ªå‹•è§¸ç™¼éƒ¨ç½²
2. **åœ¨ Zeabur é€£æ¥ GitHub** â†’ è‡ªå‹•å»ºç½®ä¸¦éƒ¨ç½²
3. **è¨­å®šç’°å¢ƒè®Šæ•¸** â†’ æœå‹™è‡ªå‹•é‡å•Ÿ
4. **åŸ·è¡Œè³‡æ–™åº«é·ç§»** â†’ å»ºç«‹è³‡æ–™è¡¨
5. **éƒ¨ç½² n8n å·¥ä½œæµç¨‹** â†’ å•Ÿç”¨è‡ªå‹•åŒ–
6. **è¨­å®š Line Webhook** â†’ é–‹å§‹æ¥æ”¶è¨Šæ¯

**ç¸½è€—æ™‚**ï¼šé¦–æ¬¡ç´„ 15-20 åˆ†é˜

---

## è©³ç´°éƒ¨ç½²æ­¥é©Ÿ

å®Œæ•´æ­¥é©Ÿè«‹åƒè€ƒ [MANUAL_SETUP_GUIDE.md](./MANUAL_SETUP_GUIDE.md)

---

## æœ¬åœ°é–‹ç™¼ç’°å¢ƒè¨­å®š

### 1. å®‰è£ä¾è³´

```bash
# å®‰è£ pnpmï¼ˆå¦‚æœé‚„æ²’å®‰è£ï¼‰
npm install -g pnpm@8

# å…‹éš†å°ˆæ¡ˆ
git clone https://github.com/your-username/grandma_linebot.git
cd grandma_linebot

# å®‰è£æ‰€æœ‰ä¾è³´
pnpm install
```

### 2. è¨­å®šç’°å¢ƒè®Šæ•¸

```bash
# è¤‡è£½ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
cp .env.example .env

# ç·¨è¼¯ .env å¡«å…¥æ‚¨çš„é‡‘é‘°
nano .env
```

### 3. è¨­å®šè³‡æ–™åº«

```bash
# å•Ÿå‹•æœ¬åœ° PostgreSQLï¼ˆä½¿ç”¨ Dockerï¼‰
docker run --name postgres -e POSTGRES_PASSWORD=password -p 5432:5432 -d postgres:15

# åŸ·è¡Œè³‡æ–™åº«é·ç§»
cd apps/linebot
pnpm prisma migrate dev
```

### 4. å•Ÿå‹•é–‹ç™¼ä¼ºæœå™¨

```bash
# å›åˆ°å°ˆæ¡ˆæ ¹ç›®éŒ„
cd ../..

# åŒæ™‚å•Ÿå‹•æ‰€æœ‰æœå‹™
pnpm dev
```

æœå‹™æœƒåœ¨ä»¥ä¸‹åŸ å£å•Ÿå‹•ï¼š
- Line Bot API: http://localhost:3000
- Admin Dashboard: http://localhost:3001

### 5. æ¸¬è©¦ Webhookï¼ˆä½¿ç”¨ ngrokï¼‰

```bash
# å®‰è£ ngrok
npm install -g ngrok

# å»ºç«‹ tunnel
ngrok http 3000

# å°‡ ngrok URL è¨­å®šåˆ° Line Developers Console
# ä¾‹å¦‚ï¼šhttps://abc123.ngrok.io/webhook/line
```

---

## ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²æª¢æŸ¥æ¸…å–®

### éƒ¨ç½²å‰

- [ ] æ‰€æœ‰æ¸¬è©¦é€šé (`pnpm test`)
- [ ] æœ¬åœ°å¯ä»¥æ­£å¸¸å»ºç½® (`pnpm build`)
- [ ] ç’°å¢ƒè®Šæ•¸å·²æº–å‚™å¥½
- [ ] è³‡æ–™åº« schema å·²ç¢ºèª
- [ ] API é‡‘é‘°éƒ½å·²å–å¾—

### Zeabur é…ç½®

- [ ] å°ˆæ¡ˆå·²å»ºç«‹
- [ ] PostgreSQL æœå‹™å·²å•Ÿå‹•
- [ ] GitHub repository å·²é€£æ¥
- [ ] ç’°å¢ƒè®Šæ•¸å·²è¨­å®šï¼ˆlinebot-apiï¼‰
- [ ] ç’°å¢ƒè®Šæ•¸å·²è¨­å®šï¼ˆadmin-dashboardï¼‰
- [ ] æœå‹™å·²æˆåŠŸéƒ¨ç½²

### éƒ¨ç½²å¾Œé©—è­‰

- [ ] linebot-api å¥åº·æª¢æŸ¥é€šé (`/health`)
- [ ] admin-dashboard å¯ä»¥è¨ªå•
- [ ] Line Webhook é©—è­‰æˆåŠŸ
- [ ] è³‡æ–™åº«é·ç§»å·²åŸ·è¡Œ
- [ ] n8n å·¥ä½œæµç¨‹å·²éƒ¨ç½²ä¸¦å•Ÿç”¨
- [ ] å¯ä»¥ç™»å…¥å¾Œå°ç®¡ç†ç³»çµ±

### åŠŸèƒ½æ¸¬è©¦

- [ ] Line Bot å¯ä»¥å›è¦†è¨Šæ¯
- [ ] AI å›è¦†å“è³ªç¬¦åˆé æœŸ
- [ ] å°è©±è¨˜æ†¶åŠŸèƒ½æ­£å¸¸
- [ ] åœ–ç‰‡ç”ŸæˆåŠŸèƒ½æ­£å¸¸ï¼ˆå¦‚å·²å•Ÿç”¨ï¼‰
- [ ] æ—©å®‰è¨Šæ¯è‡ªå‹•ç”Ÿæˆ
- [ ] å¾Œå°å¯ä»¥æŸ¥çœ‹å°è©±è¨˜éŒ„
- [ ] æ–‡æª”ä¸Šå‚³å’Œ RAG æª¢ç´¢æ­£å¸¸

---

## æ›´æ–°éƒ¨ç½²

### è‡ªå‹•æ›´æ–°ï¼ˆæ¨è–¦ï¼‰

1. åœ¨æœ¬åœ°ä¿®æ”¹ç¨‹å¼ç¢¼
2. æäº¤è®Šæ›´ï¼š
   ```bash
   git add .
   git commit -m "Update: æè¿°è®Šæ›´å…§å®¹"
   git push origin main
   ```
3. Zeabur è‡ªå‹•åµæ¸¬ä¸¦é‡æ–°éƒ¨ç½²
4. æŸ¥çœ‹ Zeabur Logs ç¢ºèªéƒ¨ç½²æˆåŠŸ

### æ‰‹å‹•æ›´æ–° n8n å·¥ä½œæµç¨‹

å¦‚æœä¿®æ”¹äº† n8n å·¥ä½œæµç¨‹ï¼š

```bash
# åœ¨ Zeabur Console æˆ–æœ¬åœ°åŸ·è¡Œ
pnpm --filter n8n-workflows deploy
```

### è³‡æ–™åº«é·ç§»

å¦‚æœä¿®æ”¹äº† Prisma schemaï¼š

```bash
# å»ºç«‹æ–°çš„é·ç§»
cd apps/linebot
pnpm prisma migrate dev --name describe_changes

# æ¨é€åˆ° GitHub
git add .
git commit -m "Database: æè¿° schema è®Šæ›´"
git push origin main
```

Zeabur éƒ¨ç½²æ™‚æœƒè‡ªå‹•åŸ·è¡Œ `prisma migrate deploy`ã€‚

---

## å›æ»¾ï¼ˆRollbackï¼‰

### æ–¹æ³• 1ï¼šGit Revert

```bash
# æ‰¾åˆ°è¦å›æ»¾çš„ commit
git log --oneline

# å›æ»¾åˆ°ç‰¹å®š commit
git revert <commit-hash>
git push origin main
```

### æ–¹æ³• 2ï¼šZeabur éƒ¨ç½²æ­·å²

1. åœ¨ Zeabur æœå‹™é é¢
2. æŸ¥çœ‹ã€ŒDeploymentsã€æ­·å²
3. é¸æ“‡ç©©å®šçš„éƒ¨ç½²ç‰ˆæœ¬
4. é»æ“Šã€ŒRedeployã€

---

## æ•ˆèƒ½ç›£æ§

### Zeabur Dashboard

- CPU ä½¿ç”¨ç‡
- è¨˜æ†¶é«”ä½¿ç”¨ç‡
- ç¶²è·¯æµé‡
- è«‹æ±‚æ¬¡æ•¸

### æ‡‰ç”¨å±¤ç›£æ§

åœ¨ linebot-api Logs ä¸­æœå°‹ï¼š
- `â±ï¸` - å›æ‡‰æ™‚é–“
- `âŒ` - éŒ¯èª¤
- `ğŸ“¤` - è¨Šæ¯ç™¼é€
- `ğŸ¨` - åœ–ç‰‡ç”Ÿæˆ

### è³‡æ–™åº«æ•ˆèƒ½

```sql
-- æŸ¥è©¢æœ€æ…¢çš„æŸ¥è©¢ï¼ˆéœ€å•Ÿç”¨ pg_stat_statementsï¼‰
SELECT query, mean_exec_time, calls
FROM pg_stat_statements
ORDER BY mean_exec_time DESC
LIMIT 10;
```

---

## æ•…éšœæ’é™¤

è©³è¦‹ [MANUAL_SETUP_GUIDE.md](./MANUAL_SETUP_GUIDE.md) çš„ã€Œæ•…éšœæ’é™¤ã€ç« ç¯€ã€‚

---

## å‚™ä»½èˆ‡ç½é›£æ¢å¾©

### è³‡æ–™åº«å‚™ä»½

1. åœ¨ Zeabur PostgreSQL æœå‹™ä¸­å•Ÿç”¨è‡ªå‹•å‚™ä»½
2. è¨­å®šæ¯æ—¥å‚™ä»½æ’ç¨‹
3. å®šæœŸä¸‹è¼‰å‚™ä»½åˆ°æœ¬åœ°

### é‚„åŸå‚™ä»½

```bash
# å¾å‚™ä»½é‚„åŸ
psql -h host -U user -d dbname < backup.sql
```

### Google Drive å‚™ä»½

åœ–ç‰‡æª”æ¡ˆå·²è‡ªå‹•å„²å­˜åœ¨ Google Driveï¼Œç„¡éœ€é¡å¤–å‚™ä»½ã€‚

---

## æˆæœ¬å„ªåŒ–

### ç›£æ§ API ä½¿ç”¨

åœ¨å¾Œå°æŸ¥çœ‹ API ä½¿ç”¨çµ±è¨ˆï¼š
- å…è²» API ä½¿ç”¨é‡
- ä»˜è²» API ä½¿ç”¨é‡å’Œæˆæœ¬
- æ¯æ—¥/æ¯æœˆè¶¨å‹¢

### å„ªåŒ–å»ºè­°

1. **å„ªå…ˆä½¿ç”¨å…è²»æ¨¡å‹**ï¼šgemini-2.5-flash, gemini-2.5-pro
2. **æ§åˆ¶åœ–ç‰‡ç”Ÿæˆé »ç‡**ï¼šè¨­å®šæ¯æ—¥é ç®—
3. **å¿«å–å¸¸ç”¨è³‡æ–™**ï¼šæ¸›å°‘è³‡æ–™åº«æŸ¥è©¢
4. **æ‰¹æ¬¡è™•ç†**ï¼šåˆä½µ API è«‹æ±‚

---

## æ“´å±•éƒ¨ç½²

### å¢åŠ é‹ç®—è³‡æº

å¦‚æœæµé‡å¢åŠ ï¼Œå¯ä»¥åœ¨ Zeabur ä¸­ï¼š
1. å‡ç´šæœå‹™æ–¹æ¡ˆ
2. å•Ÿç”¨è‡ªå‹•æ“´å±•ï¼ˆAuto Scalingï¼‰
3. å¢åŠ è³‡æ–™åº«é€£æ¥æ•¸

### å¤šå€åŸŸéƒ¨ç½²

æœªä¾†å¯è€ƒæ…®ï¼š
- åœ¨å¤šå€‹å€åŸŸéƒ¨ç½²ï¼ˆé™ä½å»¶é²ï¼‰
- ä½¿ç”¨ CDN åŠ é€Ÿéœæ…‹è³‡æº
- è³‡æ–™åº«è®€å¯«åˆ†é›¢

---

## å®‰å…¨æ€§æª¢æŸ¥

### å®šæœŸæª¢æŸ¥é …ç›®

- [ ] æ‰€æœ‰ API KEY å®šæœŸè¼ªæ›
- [ ] OAuth æ†‘è­‰æœ‰æ•ˆæœŸæª¢æŸ¥
- [ ] æª¢æŸ¥ç•°å¸¸ç™»å…¥æ´»å‹•
- [ ] å¯©è¨ˆ API å­˜å–æ—¥èªŒ
- [ ] æ›´æ–°ä¾è³´å¥—ä»¶ç‰ˆæœ¬

### å®‰å…¨å»ºè­°

1. å•Ÿç”¨ HTTPSï¼ˆZeabur é è¨­å•Ÿç”¨ï¼‰
2. è¨­å®š CORS ç™½åå–®
3. å¯¦ä½œ Rate Limiting
4. å®šæœŸå‚™ä»½è³‡æ–™
5. ç›£æ§ç•°å¸¸æ´»å‹•
